{"version":3,"file":"shallow-changes.js","sources":["../index.js"],"sourcesContent":["function baseIs(o1, o2) {\r\n\treturn o1 === o2 || (o1 !== o1 && o2 !== o2);\r\n}\r\n\r\nfunction baseIsDefined(v) {\r\n\treturn typeof v != 'undefined';\r\n}\r\n\r\nfunction isObject(o) {\r\n\treturn typeof o == 'object' && o !== null;\r\n}\r\n\r\nfunction getKeys(o, isDefined) {\r\n\tconst ret = [];\r\n\r\n\tif (Array.isArray(o)) {\r\n\t\tfor (let idx = o.length - 1; idx >= 0; idx--) {\r\n\t\t\tif (isDefined(o[idx], idx)) {\r\n\t\t\t\tret.push(idx);\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tlet keys = Object.keys(o);\r\n\t\tfor (let idx = keys.length - 1; idx >= 0; idx--) {\r\n\t\t\tlet key = keys[idx];\r\n\t\t\tif (isDefined(o[key], key)) {\r\n\t\t\t\tret.push(key);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn ret;\r\n}\r\n\r\nexport default function shallowChanges(o1, o2, config = {}) {\r\n\tconst { is = baseIs, isDefined = baseIsDefined } = config;\r\n\tlet added = [];\r\n\tlet deleted = [];\r\n\tlet equal = [];\r\n\tlet updated = [];\r\n\r\n\tif (!isObject(o1) || !isObject(o2)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (!is(o1, o2)) {\r\n\t\tconst o1Keys = getKeys(o1, isDefined);\r\n\t\tconst o2Keys = getKeys(o2, isDefined);\r\n\r\n\t\tif (o1Keys.length) {\r\n\t\t\tif (o2Keys.length) {\r\n\t\t\t\tfor (let idx = o1Keys.length - 1; idx >= 0; idx--) {\r\n\t\t\t\t\tconst key = o1Keys[idx];\r\n\t\t\t\t\tif (isDefined(o2[key], key)) {\r\n\t\t\t\t\t\tif (is(o1[key], o2[key])) {\r\n\t\t\t\t\t\t\tequal.push(key);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tupdated.push(key);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdeleted.push(key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let idx = o2Keys.length - 1; idx >= 0; idx--) {\r\n\t\t\t\t\tconst key = o2Keys[idx];\r\n\t\t\t\t\tif (!o1.hasOwnProperty(key)) {\r\n\t\t\t\t\t\tadded.push(key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdeleted = o1Keys;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tadded = o2Keys;\r\n\t\t}\r\n\t}\r\n\r\n\treturn { added, deleted, equal, updated };\r\n};\r\n"],"names":["const","let","idx","key"],"mappings":"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"}